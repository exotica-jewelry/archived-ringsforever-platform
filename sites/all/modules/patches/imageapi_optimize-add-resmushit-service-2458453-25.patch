diff --git a/imageapi_optimize.install b/imageapi_optimize.install
index 6f422ad..a92c349 100644
--- a/imageapi_optimize.install
+++ b/imageapi_optimize.install
@@ -37,3 +37,13 @@ function imageapi_optimize_update_7000() {
   }
   drupal_flush_all_caches();
 }
+
+/**
+ * If imageapi_optimize_service is set to 'smushit', change it to 'resmushit'
+ */
+function imageapi_optimize_update_7001() {
+  $var = variable_get('imageapi_optimize_service');
+  if ($var == 'smushit') {
+    variable_set('imageapi_optimize_service', 'resmushit');
+  }
+}
diff --git a/services/resmushit.inc b/services/resmushit.inc
new file mode 100644
index 0000000..d3001c4
--- /dev/null
+++ b/services/resmushit.inc
@@ -0,0 +1,54 @@
+<?php
+/**
+ * @file
+ * ReSmush.it service integration.
+ * Dedicated to old Yahoo Smush.it
+ */
+
+/**
+ * Implements imageapi_optimize_TYPE_NAME_info().
+ */
+function imageapi_optimize_services_resmushit_info() {
+  return array(
+    'title' => t('ReSmush.it'),
+    'url' => 'http://resmush.it',
+  );
+}
+
+/**
+ * Smush.it ImageAPI Optimize service callback.
+ */
+function imageapi_optimize_services_resmushit($image, $dst) {
+  $dst = drupal_realpath($dst);
+  $url = 'http://www.resmush.it/ws.php';
+  $ch = curl_init();
+  curl_setopt($ch, CURLOPT_URL, $url);
+  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
+  curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
+  curl_setopt($ch, CURLOPT_POST, TRUE);
+  if (!class_exists('CURLFile')) {
+    $arg = array('files' => '@' . $dst);
+  }
+  else {
+    $cfile = new CURLFile($dst);
+    $arg = array(
+      'files' => $cfile,
+    );
+  }
+  curl_setopt($ch, CURLOPT_POSTFIELDS, $arg);
+
+  $data = curl_exec($ch);
+  curl_close($ch);
+
+  $json = json_decode($data);
+  // SmushIt returns an error if it cannot optimize the image. Otherwise, it
+  // returns an object, with 'dest' (temporary file) and 'percent' (savings)
+  // among other properties.
+  if (!isset($json->error)) {
+    $result = drupal_http_request($json->dest);
+    if (!isset($result->error)) {
+      file_unmanaged_save_data($result->data, $dst, FILE_EXISTS_REPLACE);
+      return TRUE;
+    }
+  }
+}
diff --git a/services/smushit.inc b/services/smushit.inc
deleted file mode 100644
index 49ccc7e..0000000
--- a/services/smushit.inc
+++ /dev/null
@@ -1,48 +0,0 @@
-<?php
-/**
- * @file
- * Yahoo! Smush.it service integration.
- */
-
-/**
- * Implements imageapi_optimize_TYPE_NAME_info().
- */
-function imageapi_optimize_services_smushit_info() {
-  return array(
-    'title' => t('Yahoo! Smush.it'),
-    'url' => 'http://smush.it',
-  );
-}
-
-/**
- * Smush.it ImageAPI Optimize service callback.
- */
-function imageapi_optimize_services_smushit($image, $dst) {
-  if (!function_exists('json_decode')) {
-    drupal_set_message(t('Required function, json_decode(), is not available.'), 'error');
-    return FALSE;
-  }
-  $dst = drupal_realpath($dst);
-  $url = 'http://www.smushit.com/ysmush.it/ws.php';
-  $ch = curl_init();
-  curl_setopt($ch, CURLOPT_URL, $url);
-  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
-  curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);
-  curl_setopt($ch, CURLOPT_POST, TRUE);
-  curl_setopt($ch, CURLOPT_POSTFIELDS, array('files' => '@' . $dst));
-  $data = curl_exec($ch);
-  curl_close($ch);
-
-  $json = json_decode($data);
-
-  // SmushIt returns an error if it cannot optimize the image. Otherwise, it
-  // returns an object, with 'dest' (temporary file) and 'percent' (savings)
-  // among other properties.
-  if (!isset($json->error)) {
-    $result = drupal_http_request($json->dest);
-    if (!isset($result->error)) {
-      file_unmanaged_save_data($result->data, $dst, FILE_EXISTS_REPLACE);
-      return TRUE;
-    }
-  }
-}
